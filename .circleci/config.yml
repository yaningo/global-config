version: 2.1


jobs:
  deploy-config:
    docker:
      - image: circleci/python
    steps:
      - checkout
      - run:
          command: |
            while IFS= read -r repo
              do
                #echo "BLOB_SHA=$(curl --location --request GET 'https://api.github.com/repos/yaningo/setup-again/contents/.circleci/config.yml' --header 'Authorization: token ${GH_TOKEN}' --header 'Accept: application/vnd.github.v3+json'|jq -r .sha)" >> $BASH_ENV
                #source $BASH_ENV
                #echo $BLOB_SHA
                curl --location --request GET 'https://api.github.com/repos/yaningo/setup-again/contents/.circleci/config.yml' --header 'Authorization: token ${GH_TOKEN}' --header 'Accept: application/vnd.github.v3+json'|jq -r .sha
              done < "satellites.txt"
          name: Test

workflows:
  main:
    jobs:
      - deploy-config
